---
import Layout from '../../layouts/Layout.astro';
import Navigation from '../../components/Navigation.astro';
import { t } from '../../i18n/translations';
import Footer from '../../components/Footer.astro';
import '../../styles/global.css';

const lang = 'en';
const base = import.meta.env.BASE_URL;
---

<Layout title="Implementation | Research Journey">
  <Navigation lang={lang} currentPath="/journey/implementation" />

  <main class="min-h-screen bg-[#FFF9ED] relative">
    <div class="absolute inset-0 opacity-5 pointer-events-none">
      <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <pattern id="grid-impl" width="40" height="40" patternUnits="userSpaceOnUse">
            <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#003049" stroke-width="1"/>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#grid-impl)" />
      </svg>
    </div>
    <!-- Hero Section -->
    <section class="relative py-20 px-6 overflow-hidden">


      <div class="max-w-5xl mx-auto relative z-10">
        <!-- Breadcrumb -->
        <div class="mb-8">
          <a href={base + "journey"} class="text-sm text-[#003049]/60 hover:text-[#780000] transition-colors inline-flex items-center gap-2 font-figtree font-bold uppercase tracking-wider">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Back to Journey
          </a>
        </div>

        <!-- Title -->
        <div class="mb-8">
          <div class="inline-block px-4 py-2 bg-[#780000]/10 text-[#780000] rounded-lg text-sm font-bold uppercase tracking-widest mb-6 border border-[#780000]/20">
            Phase 4 • Current Phase
          </div>
          <h1 class="font-figtree text-5xl md:text-6xl font-bold text-[#003049] mb-6 leading-tight">Making It Real</h1>
          <p class="font-figtree text-xl text-[#003049]/70 leading-relaxed max-w-3xl">
            From <strong>piloting</strong> to <em class="italic font-serif">behavioral testing</em> to <strong>fMRI</strong>. This is where theory meets human decision-making.
          </p>
        </div>
      </div>
    </section>

    <!-- Main Content -->
    <section class="py-12 px-6 relative">
      <div class="max-w-5xl mx-auto space-y-16">

        <!-- Overview -->
        <div class="bg-[#FFF9ED] border border-[#003049]/10 rounded-2xl overflow-hidden shadow-sm">
          <div class="grid md:grid-cols-12">
            <div class="md:col-span-1 bg-[#780000] flex items-center justify-center p-4">
              <div class="font-figtree text-4xl font-black text-[#FFF9ED] opacity-50 rotate-90 md:rotate-0">01</div>
            </div>
            <div class="md:col-span-11 p-8 md:p-12">
              <h2 class="font-figtree text-3xl font-bold text-[#003049] mb-6">From Theory to Practice</h2>
              <div class="space-y-6">
                <p class="font-figtree text-lg text-[#003049]/80 leading-relaxed">
                  We have <strong>286 optimized trials</strong> that maximize parameter discriminability. We have <strong>16 nested models</strong> ready to test. Now comes the real work: testing this framework with <em class="italic font-serif">real human behavior</em>.
                </p>
                <div class="bg-[#003049]/5 border border-[#003049]/10 p-8 rounded-xl border-l-4 border-l-[#780000]">
                  <p class="font-figtree text-lg text-[#003049]/80 leading-relaxed">
                    Three stages: <strong>Piloting</strong> to refine the experiment. <strong>Behavioral testing</strong> with 100 participants. <strong>fMRI</strong> to see what the brain is doing.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Three Stages -->
        <div class="pl-8 border-l-2 border-[#669bbc]/30">
          <div class="bg-[#FFF9ED] p-8 rounded-2xl border border-[#003049]/10 shadow-sm">
            <h2 class="font-figtree text-3xl font-bold text-[#003049] mb-8">The Experimental Pipeline</h2>

            <div class="space-y-8">
              <!-- Stage 1: Piloting -->
              <div class="bg-[#FFF9ED] border border-[#669bbc]/20 p-8 rounded-xl shadow-sm">
                <div class="flex items-center gap-4 mb-6">
                  <div class="w-12 h-12 bg-[#669bbc] rounded-full flex items-center justify-center text-[#FFF9ED] font-bold text-xl">1</div>
                  <div>
                    <h3 class="font-figtree text-2xl font-bold text-[#669bbc]">Piloting</h3>
                    <span class="inline-block px-2 py-0.5 bg-[#669bbc]/10 text-[#669bbc] text-xs font-bold uppercase rounded mt-1">Currently Running</span>
                  </div>
                </div>

                <div class="space-y-6">
                  <p class="font-figtree text-lg text-[#003049]/80 leading-relaxed">
                    We're running pilot studies to optimize the experiment. Starting with 286 trials was too long—participants got fatigued. The goal: reduce to <strong>150 trials per condition</strong> without losing parameter discriminability.
                  </p>

                  <div class="bg-[#669bbc]/5 border border-[#669bbc]/10 p-6 rounded-xl">
                    <p class="font-figtree text-sm font-bold text-[#669bbc] mb-3">What we're learning:</p>
                    <ul class="space-y-2 font-figtree text-sm text-[#003049]/80">
                      <li class="flex items-start gap-2"><span class="text-[#669bbc]">•</span> Which trials are most informative in practice</li>
                      <li class="flex items-start gap-2"><span class="text-[#669bbc]">•</span> How to keep participants engaged throughout the study</li>
                      <li class="flex items-start gap-2"><span class="text-[#669bbc]">•</span> What instructions actually make sense to real people</li>
                      <li class="flex items-start gap-2"><span class="text-[#669bbc]">•</span> Response time patterns and attention checks that work</li>
                    </ul>
                  </div>

                  <div class="grid grid-cols-3 gap-4">
                    <div class="bg-[#FFF9ED] border border-[#003049]/5 p-4 rounded-lg text-center">
                      <p class="font-figtree text-xs text-[#003049]/60 mb-1 uppercase tracking-wide">Current</p>
                      <p class="font-figtree text-2xl font-black text-[#669bbc]">286</p>
                    </div>
                    <div class="bg-[#FFF9ED] border border-[#003049]/5 p-4 rounded-lg text-center">
                      <p class="font-figtree text-xs text-[#003049]/60 mb-1 uppercase tracking-wide">Target</p>
                      <p class="font-figtree text-2xl font-black text-[#003049]">150</p>
                    </div>
                    <div class="bg-[#FFF9ED] border border-[#003049]/5 p-4 rounded-lg text-center">
                      <p class="font-figtree text-xs text-[#003049]/60 mb-1 uppercase tracking-wide">Conditions</p>
                      <p class="font-figtree text-2xl font-black text-[#003049]">2×</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Stage 2: Behavioral -->
              <div class="bg-[#FFF9ED] border border-[#003049]/10 p-8 rounded-xl shadow-sm">
                <div class="flex items-center gap-4 mb-6">
                  <div class="w-12 h-12 bg-[#003049] rounded-full flex items-center justify-center text-[#FFF9ED] font-bold text-xl">2</div>
                  <div>
                    <h3 class="font-figtree text-2xl font-bold text-[#003049]">Behavioral Experiment</h3>
                    <span class="inline-block px-2 py-0.5 bg-[#003049]/10 text-[#003049] text-xs font-bold uppercase rounded mt-1">Next Phase</span>
                  </div>
                </div>

                <div class="space-y-6">
                  <p class="font-figtree text-lg text-[#003049]/80 leading-relaxed">
                    Once piloting is complete, we'll run the full behavioral study with <strong>100 participants</strong>. This will give us the data to test whether Prospect Theory can explain trust, or if we need additional social preference parameters.
                  </p>

                  <div class="grid md:grid-cols-2 gap-8">
                    <div>
                      <p class="font-figtree text-sm font-bold text-[#003049] mb-3 uppercase tracking-wide">Study Design</p>
                      <ul class="space-y-2 font-figtree text-sm text-[#003049]/80">
                        <li class="flex items-start gap-2"><span class="text-[#003049] font-bold">•</span> <strong>N = 100 participants</strong></li>
                        <li class="flex items-start gap-2"><span class="text-[#003049] font-bold">•</span> <strong>300 trials total</strong> (150 per condition)</li>
                        <li class="flex items-start gap-2"><span class="text-[#003049] font-bold">•</span> Within-subject design</li>
                        <li class="flex items-start gap-2"><span class="text-[#003049] font-bold">•</span> Real stakes (€8 base + bonus)</li>
                      </ul>
                    </div>

                    <div>
                      <p class="font-figtree text-sm font-bold text-[#003049] mb-3 uppercase tracking-wide">Hypotheses</p>
                      <ul class="space-y-2 font-figtree text-sm text-[#003049]/80">
                        <li class="flex items-start gap-2"><span class="text-[#003049] font-bold">•</span> Do <strong>α, λ, γ⁺, δ</strong> differ?</li>
                        <li class="flex items-start gap-2"><span class="text-[#003049] font-bold">•</span> Which of 16 models fits best?</li>
                        <li class="flex items-start gap-2"><span class="text-[#003049] font-bold">•</span> Individual differences prediction</li>
                        <li class="flex items-start gap-2"><span class="text-[#003049] font-bold">•</span> Betrayal aversion existence</li>
                      </ul>
                    </div>
                  </div>

                  <div class="bg-[#003049]/5 p-4 rounded-lg flex items-start gap-3">
                    <svg class="w-5 h-5 text-[#003049] mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    <p class="font-figtree text-sm text-[#003049]/80 leading-relaxed">
                      <strong>Power analysis:</strong> With 100 participants × 300 trials = 30,000 observations, we have &gt;95% power to detect medium effect sizes (Cohen's d = 0.5) in parameter differences.
                    </p>
                  </div>
                </div>
              </div>

            <!-- Stage 3: fMRI -->
            <div class="bg-[#FFF9ED] border border-[#780000]/20 p-8 rounded-xl shadow-sm">
              <div class="flex items-center gap-4 mb-6">
                <div class="w-12 h-12 bg-[#780000] rounded-full flex items-center justify-center text-[#FFF9ED] font-bold text-xl">3</div>
                <div>
                  <h3 class="font-figtree text-2xl font-bold text-[#780000]">fMRI Study</h3>
                  <span class="inline-block px-2 py-0.5 bg-[#780000]/10 text-[#780000] text-xs font-bold uppercase rounded mt-1">Future Phase</span>
                </div>
              </div>

              <div class="space-y-6">
                <p class="font-figtree text-lg text-[#003049]/80 leading-relaxed">
                  Once we know which trials and parameters matter behaviorally, we'll run an fMRI study to see <em class="italic font-serif">where in the brain</em> these computations happen. Shorter design: <strong>70 trials per condition</strong>.
                </p>

                <div class="bg-[#780000]/5 border border-[#780000]/10 p-6 rounded-xl">
                  <p class="font-figtree text-sm font-bold text-[#780000] mb-3">Why fMRI?</p>
                  <ul class="space-y-2 font-figtree text-sm text-[#003049]/80">
                    <li class="flex items-start gap-2"><span class="text-[#780000]">•</span> See if <strong>brain regions</strong> differ between Trust and Risk</li>
                    <li class="flex items-start gap-2"><span class="text-[#780000]">•</span> Test if <em class="italic font-serif">value signals</em> are computed differently</li>
                    <li class="flex items-start gap-2"><span class="text-[#780000]">•</span> Look for neural signatures of betrayal aversion</li>
                    <li class="flex items-start gap-2"><span class="text-[#780000]">•</span> Validate computational model neural correlates</li>
                  </ul>
                </div>

                <div class="grid grid-cols-2 gap-4">
                  <div class="bg-[#FFF9ED] border border-[#780000]/10 p-4 rounded-lg text-center">
                    <p class="font-figtree text-xs text-[#003049]/60 mb-1 uppercase tracking-wide">Participants</p>
                    <p class="font-figtree text-2xl font-black text-[#780000]">55</p>
                  </div>
                  <div class="bg-[#FFF9ED] border border-[#780000]/10 p-4 rounded-lg text-center">
                    <p class="font-figtree text-xs text-[#003049]/60 mb-1 uppercase tracking-wide">Trials / Condition</p>
                    <p class="font-figtree text-2xl font-black text-[#780000]">70</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- The Experimental Platform -->
        <div class="bg-[#003049] p-12 rounded-2xl text-[#FFF9ED] relative overflow-hidden">
          <div class="absolute top-0 right-0 w-96 h-96 bg-[#669bbc] rounded-full filter blur-[100px] opacity-20 transform translate-x-1/2 -translate-y-1/2"></div>
          
          <div class="relative z-10">
            <h2 class="font-figtree text-3xl font-bold mb-8">The Experimental Platform</h2>
            
            <div class="grid md:grid-cols-2 gap-12">
              <div>
                <p class="font-figtree text-lg text-[#FFF9ED]/80 leading-relaxed mb-6">
                  To ensure precise timing and control, we built a custom <strong>PsychoPy</strong> framework for in-person testing at the Donders Institute.
                </p>
                
                <div class="space-y-4">
                  <div class="flex items-center gap-4 bg-[#FFF9ED]/5 p-4 rounded-xl border border-[#FFF9ED]/10">
                    <div class="w-10 h-10 bg-[#669bbc]/20 rounded-lg flex items-center justify-center text-[#669bbc]">
                      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                    </div>
                    <div>
                      <p class="font-bold text-[#FFF9ED]">Dual-Task Paradigm</p>
                      <p class="text-sm text-[#FFF9ED]/60">Trustee Role (Phase 1) & Trustor Role (Phase 2)</p>
                    </div>
                  </div>

                  <div class="flex items-center gap-4 bg-[#FFF9ED]/5 p-4 rounded-xl border border-[#FFF9ED]/10">
                    <div class="w-10 h-10 bg-[#780000]/20 rounded-lg flex items-center justify-center text-[#780000]">
                      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                    </div>
                    <div>
                      <p class="font-bold text-[#FFF9ED]">Optimized Trials</p>
                      <p class="text-sm text-[#FFF9ED]/60">286 trials selected via Fisher Information</p>
                    </div>
                  </div>

                  <div class="flex items-center gap-4 bg-[#FFF9ED]/5 p-4 rounded-xl border border-[#FFF9ED]/10">
                    <div class="w-10 h-10 bg-[#669bbc]/20 rounded-lg flex items-center justify-center text-[#669bbc]">
                      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                    </div>
                    <div>
                      <p class="font-bold text-[#FFF9ED]">Social vs Non-Social</p>
                      <p class="text-sm text-[#FFF9ED]/60">Human faces vs Lottery objects</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="bg-[#000000]/30 rounded-xl p-6 font-mono text-sm text-[#FFF9ED]/80 border border-[#FFF9ED]/10">
                <div class="flex items-center gap-2 mb-4 border-b border-[#FFF9ED]/10 pb-2">
                  <div class="w-3 h-3 rounded-full bg-[#ff5f56]"></div>
                  <div class="w-3 h-3 rounded-full bg-[#ffbd2e]"></div>
                  <div class="w-3 h-3 rounded-full bg-[#27c93f]"></div>
                  <span class="ml-2 text-xs opacity-50">experiment_structure.yaml</span>
                </div>
                <div class="space-y-1">
                  <p><span class="text-[#669bbc]">experiment:</span></p>
                  <p class="pl-4"><span class="text-[#FFF9ED]">platform:</span> <span class="text-[#e6c07b]">"PsychoPy"</span></p>
                  <p class="pl-4"><span class="text-[#FFF9ED]">location:</span> <span class="text-[#e6c07b]">"In-Person (Donders)"</span></p>
                  <p class="pl-4"><span class="text-[#FFF9ED]">phases:</span></p>
                  <p class="pl-8"><span class="text-[#669bbc]">-</span> <span class="text-[#FFF9ED]">name:</span> <span class="text-[#e6c07b]">"Reciprocation Task"</span></p>
                  <p class="pl-10"><span class="text-[#FFF9ED]">role:</span> <span class="text-[#e6c07b]">"Trustee"</span></p>
                  <p class="pl-8"><span class="text-[#669bbc]">-</span> <span class="text-[#FFF9ED]">name:</span> <span class="text-[#e6c07b]">"Inverted Trust Game"</span></p>
                  <p class="pl-10"><span class="text-[#FFF9ED]">role:</span> <span class="text-[#e6c07b]">"Trustor"</span></p>
                  <p class="pl-10"><span class="text-[#FFF9ED]">conditions:</span> <span class="text-[#e6c07b]">["Social", "Non-Social"]</span></p>
                  <p class="pl-4"><span class="text-[#FFF9ED]">stimuli:</span></p>
                  <p class="pl-8"><span class="text-[#FFF9ED]">faces:</span> <span class="text-[#e6c07b]">"Chicago Face Database (N=300)"</span></p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Next Phase Navigation -->
        <!-- Next Phase Navigation -->
        <div class="text-center mt-16 pt-16 border-t border-[#003049]/10">
          <p class="font-figtree text-lg text-[#003049]/80 leading-relaxed max-w-3xl mx-auto mb-8">
            The platform is ready. The design is optimized. Time to test it in the real world.
          </p>
          <a href={base + "journey/data-collection"} class="inline-flex items-center gap-2 px-8 py-4 bg-[#003049] text-[#FFF9ED] rounded-full font-bold hover:bg-[#780000] transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-1">
            Explore Phase 5: Data Collection
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
          </a>
        </div>

      </div>
    </section>
  </main>

  <Footer lang={lang} />
</Layout>
